generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialActions"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model user {
  userId   Int        @id @unique @default(autoincrement())
  userName String     @unique @db.VarChar(45)
  password String     @db.Char(64)
  email    String     @unique @db.VarChar(45)
  fName    String     @db.VarChar(45)
  lName    String     @db.VarChar(45)
  status   Boolean    @default(false)
  cart     cart[]
  keygames keygames[]
}

model platform {
  pId      Int        @id @unique @default(autoincrement())
  pName    String     @unique @db.VarChar(50)
  keygames keygames[]
}

model cart {
  cartId         Int      @id @unique @default(autoincrement())
  keygames_keyId Int
  user_userId    Int
  keygames       keygames @relation(fields: [keygames_keyId], references: [keyId], onDelete: Cascade, onUpdate: NoAction)
  user           user     @relation(fields: [user_userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)

  @@index([keygames_keyId], name: "fk_keygames_has_user_keygames1_idx")
  @@index([user_userId], name: "fk_keygames_has_user_user1_idx")
}

model gamedeveloper {
  devId    Int        @id @unique @default(autoincrement())
  devName  String     @db.VarChar(50)
  keygames keygames[]
}

model gametags {
  tagId       Int           @id @unique @default(autoincrement())
  tagName     String        @unique @db.VarChar(45)
  keycategory keycategory[]
}

model keycategory {
  kcId           Int      @id @default(autoincrement())
  keygames_keyID Int
  gametags_tagId Int
  gametags       gametags @relation(fields: [gametags_tagId], references: [tagId], onDelete: Cascade, onUpdate: NoAction)
  keygames       keygames @relation(fields: [keygames_keyID], references: [keyId], onDelete: Cascade, onUpdate: NoAction)

  @@index([gametags_tagId], name: "fk_keygames_has_gametags_gametags1_idx")
  @@index([keygames_keyID], name: "fk_keygames_has_gametags_keygames1_idx")
}

model keygames {
  keyId               Int           @unique @default(autoincrement())
  gameName            String        @db.VarChar(50)
  gameDetail          String        @db.VarChar(2000)
  price               Decimal       @db.Decimal(7, 2)
  releaseDate         DateTime      @db.Date
  images              String?       @unique @db.VarChar(100)
  gamedeveloper_devId Int
  Platform_pId        Int
  user_userId         Int
  platform            platform      @relation(fields: [Platform_pId], references: [pId], onDelete: Cascade, onUpdate: NoAction)
  gamedeveloper       gamedeveloper @relation(fields: [gamedeveloper_devId], references: [devId], onDelete: Cascade, onUpdate: NoAction)
  user                user          @relation(fields: [user_userId], references: [userId], onDelete: Cascade, onUpdate: NoAction)
  cart                cart[]
  keycategory         keycategory[]

  @@id([keyId, gamedeveloper_devId, Platform_pId, user_userId])
  @@index([Platform_pId], name: "fk_keygames_Platform1_idx")
  @@index([gamedeveloper_devId], name: "fk_keygames_gamedeveloper1_idx")
  @@index([user_userId], name: "fk_keygames_user1_idx")
}

model admin {
  adminId  Int    @id @unique @default(autoincrement())
  userName String @unique @db.VarChar(45)
  password String @db.VarChar(100)
}

model logoutToken {
  token String @id @unique @db.VarChar(500)
}
